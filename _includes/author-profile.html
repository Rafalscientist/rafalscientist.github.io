{% if page.author and site.data.authors[page.author] %}
  {% assign author = site.data.authors[page.author] %}
{% else %}
  {% assign author = site.author %}
{% endif %}

<div itemscope itemtype="http://schema.org/Person">

  <style>
    /* ATOMOWE WYMUSZENIE LINII DLA PWR I IFT */
    .author__urls .author__desktop {
      display: flex !important;
      align-items: center !important; /* Środkuje pionowo obrazek i tekst */
      flex-wrap: nowrap !important; /* Zabrania spadania tekstu pod obrazek */
      line-height: 1.2 !important;
      margin-bottom: 5px !important;
    }

    /* Styl dla obrazków w sidebarze */
    .sidebar-icon-img {
      width: 18px !important;
      height: 18px !important;
      margin-right: 8px !important;
      flex-shrink: 0 !important; /* Obrazek nie zostanie ściśnięty */
      filter: none !important;
    }

    /* Specyficzna inwersja dla loga Academia w trybie ciemnym */
    html[data-theme='dark'] .img-ac-atom {
      filter: invert(1) brightness(2) !important;
    }

    /* Kontrast dla IFT w trybie jasnym */
    .img-ift-atom {
      filter: drop-shadow(0px 0px 1px rgba(0,0,0,0.8)) !important;
    }
    html[data-theme='dark'] .img-ift-atom {
      filter: none !important;
    }
  </style>

  <div class="author__avatar">
    {% if author.avatar contains "://" %}
    	<img src="{{ author.avatar }}" alt="{{ author.name }}"  fetchpriority="high" />
    {% else %}
    	<img src="{{ author.avatar | prepend: "/images/" | prepend: base_path }}" class="author__avatar" alt="{{ author.name }}"  fetchpriority="high" />
    {% endif %}
  </div>

  <div class="author__content">
    <h3 class="author__name">{{ author.name }}</h3>
    {% if author.pronouns %}<p class="author__pronouns">{{ author.pronouns }}</p>{% endif %}
    {% if author.bio %}<p class="author__bio">{{ author.bio }}</p>{% endif %}
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      <!-- Font Awesome icons / Biographic information  -->
      <!-- Lokalizacja: Politechnika Wrocławska (Zamiast pinezki) -->
      {% if author.location %}
        <li class="author__desktop">
          <img src="{{ '/images/logopwr.png' | relative_url }}" 
               class="sidebar-icon-img" 
               alt="PWr Logo">
          {{ author.location }}
        </li>
      {% endif %}
      <!-- Instytut Fizyki Teoretycznej (IFT) - Wersja z wysokim kontrastem -->
      {% if author.employer %}
        <li class="author__desktop">
          <style>
            /* WERSJA ATOMOWA DLA IFT: Cień widoczny tylko w jasnym trybie */
            .img-ift {
              /* Podwójny filtr: jeden ciemny do obrysu liter, drugi szary do głębi */
              filter: drop-shadow(0px 0px 1px rgba(0,0,0,0.8)) 
                      drop-shadow(0px 0px 2px rgba(0,0,0,0.3)) !important;
              background-color: transparent !important;
            }
            /* W trybie ciemnym wyłączamy obrys, bo białe elementy same świecą na czarnym tle */
            html[data-theme='dark'] .img-ift {
              filter: none !important;
            }
          </style>
          <img src="{{ '/images/logoift.png' | relative_url }}" 
               class="img-ift"
               style="width:18px; height:18px; margin-right:8px; vertical-align:middle;">{{ author.employer }}
        </li>
      {% endif %}
      <!-- Academia - Wersja z inteligentnym filtrem nocnym -->
      {% if author.academia %}
        <li>
          <a href="{{ author.academia }}" target="_blank" rel="noopener noreferrer">
            <style>
              /* Ten styl lokalny wymusi biały kolor tylko w trybie ciemnym */
              html[data-theme='dark'] .img-ac { 
                filter: invert(1) brightness(2) !important; 
              }
            </style>
            <img src="{{ '/images/logoac.svg' | relative_url }}" 
                 class="img-ac"
                 style="width:16px; height:16px; margin-right:8px; vertical-align:middle; filter:none;">Academia
          </a>
        </li>
      {% endif %}
      <!-- ORCID -->
      {% if author.orcid %}
        <li>
          <a href="{{ author.orcid }}" target="_blank" rel="noopener noreferrer">
            <img src="{{ '/images/logoorcid.svg' | relative_url }}" 
                 style="width: 17px; height: 17px; margin-right: 8px; vertical-align: middle; filter: none !important;">ORCID
          </a>
        </li>
      {% endif %}
      <!-- ResearchGate -->
      {% if author.researchgate %}
        <li>
          <a href="{{ author.researchgate }}" target="_blank" rel="noopener noreferrer">
            <img src="{{ '/images/logorg.svg' | relative_url }}" 
                 style="width: 17px; height: 17px; margin-right: 8px; vertical-align: middle; filter: none !important;">ResearchGate
          </a>
        </li>
      {% endif %}    
    </ul>
  </div>
</div>
